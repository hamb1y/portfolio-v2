---
import Layout from "../../components/Layout.astro";
import { getCollection, render } from 'astro:content';

export async function getStaticPaths() {
  const blogPosts = await getCollection('blog');
  return blogPosts.map((post) => ({
    params: { slug: post.slug },
    props: { post },
  }));
}

const { post } = Astro.props;
const { title, description, date, readTime, tags, image } = post.data;
const { Content } = await render(post);
---

<Layout title={title} description={description}>
  <div class="min-h-screen pt-32">
    <div class="container max-w-4xl">
      <article class="glass-panel p-8">
        {image && (
          <img 
            src={image} 
            alt={title} 
            class="w-full h-64 object-cover rounded-lg mb-8"
          />
        )}
        
        <header class="mb-8">
          <h1 class="text-4xl font-bold mb-4">{title}</h1>
          <div class="flex flex-wrap items-center gap-4 text-text-muted">
            <time>{new Date(date).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</time>
            {readTime && <span>â€¢ {readTime} read</span>}
          </div>
          {tags && tags.length > 0 && (
            <div class="flex flex-wrap gap-2 mt-4">
              {tags.map((tag) => (
                <span class="glass-badge">{tag}</span>
              ))}
            </div>
          )}
        </header>
        
        <div class="prose prose-invert max-w-none">
          <Content />
        </div>
        
        <footer class="mt-12 pt-8 border-t border-border">
          <a href="/blog" class="btn-secondary btn">&larr; Back to Blog</a>
        </footer>
      </article>
    </div>
  </div>
</Layout>